---
// src/components/Navbar.astro
interface Alt { lang: string; url: string }

const {
  lang = "th",
  showLinks = true,
  alternates = [] as Alt[],
} = Astro.props as {
  lang?: "th" | "en";
  showLinks?: boolean;
  alternates?: Alt[];
};

// หา URL ของภาษา
function altUrl(target: "th" | "en") {
  const found = alternates.find((a) => a.lang.toLowerCase() === target);
  if (found?.url) return found.url;
  return `/${target}`;
}
---

<nav class="bg-white/98 backdrop-blur-md border-b border-gray-100/50 sticky top-0 z-50 shadow-sm">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-4">
    <div class="flex items-center justify-between">
      
      <!-- Logo - เหมือนในรูป -->
      <a href={`/${lang}`} class="flex items-center gap-3 hover:scale-105 transition-transform duration-200">
        <div class="w-12 h-12 bg-gradient-to-br from-cyan-400 to-blue-500 rounded-2xl flex items-center justify-center shadow-lg hover:shadow-xl transition-shadow duration-200">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M7 14c-1.66 0-3 1.34-3 3 0 1.31.84 2.41 2 2.83V22h2v-2.17c1.16-.41 2-1.52 2-2.83 0-1.66-1.34-3-3-3zM20.5 6c-.28 0-.5.22-.5.5V8h-1V6.5c0-.28-.22-.5-.5-.5s-.5.22-.5.5V8H4V6.5C4 6.22 3.78 6 3.5 6S3 6.22 3 6.5V18c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.28-.22-.5-.5-.5z" fill="white"/>
          </svg>
        </div>
        <span class="text-2xl font-bold bg-gradient-to-r from-cyan-500 to-blue-600 bg-clip-text text-transparent">
          Bearly
        </span>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden lg:flex items-center gap-10">
        {showLinks && (
          <ul class="flex items-center gap-8">
            <li>
              <a href={`/${lang}`} class="text-gray-700 hover:text-blue-600 transition-colors font-medium text-lg relative group">
                {lang === "en" ? "Home" : "หน้าหลัก"}
                <span class="absolute inset-x-0 -bottom-1 h-0.5 bg-blue-600 scale-x-0 group-hover:scale-x-100 transition-transform duration-200"></span>
              </a>
            </li>
            <li>
              <a href="#products" class="text-gray-700 hover:text-blue-600 transition-colors font-medium text-lg relative group">
                {lang === "en" ? "Products" : "ผลิตภัณฑ์"}
                <span class="absolute inset-x-0 -bottom-1 h-0.5 bg-blue-600 scale-x-0 group-hover:scale-x-100 transition-transform duration-200"></span>
              </a>
            </li>
            <li>
              <a href="#about" class="text-gray-700 hover:text-blue-600 transition-colors font-medium text-lg relative group">
                {lang === "en" ? "About Us" : "เกี่ยวกับเรา"}
                <span class="absolute inset-x-0 -bottom-1 h-0.5 bg-blue-600 scale-x-0 group-hover:scale-x-100 transition-transform duration-200"></span>
              </a>
            </li>
            <li>
              <a href="#contact" class="text-gray-700 hover:text-blue-600 transition-colors font-medium text-lg relative group">
                {lang === "en" ? "Contact" : "ติดต่อ"}
                <span class="absolute inset-x-0 -bottom-1 h-0.5 bg-blue-600 scale-x-0 group-hover:scale-x-100 transition-transform duration-200"></span>
              </a>
            </li>
          </ul>
        )}

        <!-- Language Switcher - Enhanced -->
        <div class="flex items-center gap-1 bg-gray-50 rounded-full p-1.5 border border-gray-200 hover:border-gray-300 transition-colors">
          <a href={altUrl("th")}
             class={`px-4 py-2 rounded-full text-sm font-semibold transition-all duration-200 ${
               lang === "th" 
                 ? "bg-gradient-to-r from-cyan-500 to-blue-600 text-white shadow-md transform scale-105" 
                 : "text-gray-600 hover:text-gray-800 hover:bg-white"
             }`}>
            TH
          </a>
          <a href={altUrl("en")}
             class={`px-4 py-2 rounded-full text-sm font-semibold transition-all duration-200 ${
               lang === "en" 
                 ? "bg-gradient-to-r from-cyan-500 to-blue-600 text-white shadow-md transform scale-105" 
                 : "text-gray-600 hover:text-gray-800 hover:bg-white"
             }`}>
            EN
          </a>
        </div>
      </div>

      <!-- Mobile menu button - Enhanced -->
      <button 
        class="lg:hidden flex items-center justify-center w-12 h-12 rounded-xl bg-gray-50 hover:bg-gray-100 transition-all duration-200 group"
        id="mobile-menu-button"
        aria-label="Toggle mobile menu"
      >
        <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2.5" class="text-gray-700 group-hover:text-blue-600 transition-colors">
          <path d="M3 12h18M3 6h18M3 18h18" class="group-hover:stroke-blue-600"/>
        </svg>
      </button>
    </div>

    <!-- Mobile Navigation Menu - Enhanced -->
    <div class="lg:hidden hidden animate-fade-in" id="mobile-menu">
      <div class="mt-6 p-6 bg-white rounded-2xl shadow-2xl border border-gray-100 backdrop-blur-sm">
        {showLinks && (
          <ul class="space-y-4 mb-6">
            <li>
              <a href={`/${lang}`} class="block text-gray-700 hover:text-blue-600 transition-colors font-medium text-lg py-3 px-4 rounded-xl hover:bg-blue-50">
                {lang === "en" ? "Home" : "หน้าหลัก"}
              </a>
            </li>
            <li>
              <a href="#products" class="block text-gray-700 hover:text-blue-600 transition-colors font-medium text-lg py-3 px-4 rounded-xl hover:bg-blue-50">
                {lang === "en" ? "Products" : "ผลิตภัณฑ์"}
              </a>
            </li>
            <li>
              <a href="#about" class="block text-gray-700 hover:text-blue-600 transition-colors font-medium text-lg py-3 px-4 rounded-xl hover:bg-blue-50">
                {lang === "en" ? "About Us" : "เกี่ยวกับเรา"}
              </a>
            </li>
            <li>
              <a href="#contact" class="block text-gray-700 hover:text-blue-600 transition-colors font-medium text-lg py-3 px-4 rounded-xl hover:bg-blue-50">
                {lang === "en" ? "Contact" : "ติดต่อ"}
              </a>
            </li>
          </ul>
        )}
        
        <!-- Mobile Language Switcher - Enhanced -->
        <div class="pt-4 border-t border-gray-100">
          <p class="text-sm font-semibold text-gray-500 mb-3 text-center">
            {lang === "en" ? "Choose Language" : "เลือกภาษา"}
          </p>
          <div class="grid grid-cols-2 gap-3">
            <a href={altUrl("th")}
               class={`text-center px-4 py-3 rounded-xl font-semibold transition-all duration-200 ${
                 lang === "th" 
                   ? "bg-gradient-to-r from-cyan-500 to-blue-600 text-white shadow-lg transform scale-105" 
                   : "bg-gray-50 text-gray-700 hover:bg-gray-100 hover:text-blue-600"
               }`}>
              ไทย
            </a>
            <a href={altUrl("en")}
               class={`text-center px-4 py-3 rounded-xl font-semibold transition-all duration-200 ${
                 lang === "en" 
                   ? "bg-gradient-to-r from-cyan-500 to-blue-600 text-white shadow-lg transform scale-105" 
                   : "bg-gray-50 text-gray-700 hover:bg-gray-100 hover:text-blue-600"
               }`}>
              English
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

<script>
  // Enhanced mobile menu toggle with animations
  document.addEventListener('DOMContentLoaded', function() {
    const button = document.getElementById('mobile-menu-button');
    const menu = document.getElementById('mobile-menu');
    
    if (button && menu) {
      button.addEventListener('click', function(e) {
        e.stopPropagation();
        
        if (menu.classList.contains('hidden')) {
          // Show menu
          menu.classList.remove('hidden');
          menu.style.opacity = '0';
          menu.style.transform = 'translateY(-10px)';
          
          // Animate in
          requestAnimationFrame(() => {
            menu.style.transition = 'opacity 0.2s ease-out, transform 0.2s ease-out';
            menu.style.opacity = '1';
            menu.style.transform = 'translateY(0)';
          });
        } else {
          // Hide menu
          menu.style.transition = 'opacity 0.15s ease-in, transform 0.15s ease-in';
          menu.style.opacity = '0';
          menu.style.transform = 'translateY(-5px)';
          
          setTimeout(() => {
            menu.classList.add('hidden');
          }, 150);
        }
      });
      
      // Close menu when clicking outside
      document.addEventListener('click', function(e) {
        if (!button.contains(e.target as Node) && !menu.contains(e.target as Node)) {
          if (!menu.classList.contains('hidden')) {
            menu.style.transition = 'opacity 0.15s ease-in, transform 0.15s ease-in';
            menu.style.opacity = '0';
            menu.style.transform = 'translateY(-5px)';
            
            setTimeout(() => {
              menu.classList.add('hidden');
            }, 150);
          }
        }
      });

      // Close menu when pressing Escape
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && !menu.classList.contains('hidden')) {
          menu.style.transition = 'opacity 0.15s ease-in, transform 0.15s ease-in';
          menu.style.opacity = '0';
          menu.style.transform = 'translateY(-5px)';
          
          setTimeout(() => {
            menu.classList.add('hidden');
          }, 150);
        }
      });
    }
  });
</script>

<style>
  /* Enhanced animations and transitions */
  .animate-fade-in {
    animation: fadeIn 0.2s ease-out forwards;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Smooth gradient text */
  .bg-clip-text {
    -webkit-background-clip: text;
    background-clip: text;
  }

  /* Enhanced hover effects */
  .group:hover .group-hover\:stroke-blue-600 {
    stroke: #2563eb;
  }

  /* Backdrop blur support */
  @supports (backdrop-filter: blur()) {
    .backdrop-blur-md {
      backdrop-filter: blur(12px);
    }
    .backdrop-blur-sm {
      backdrop-filter: blur(4px);
    }
  }

  /* Smooth transitions for all elements */
  * {
    transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    transition-duration: 150ms;
  }

  /* Enhanced focus states for accessibility */
  a:focus-visible,
  button:focus-visible {
    outline: 2px solid #2563eb;
    outline-offset: 2px;
    border-radius: 8px;
  }
</style>