---
import "../styles/global.css";
import Navbar from "../components/Navbar.astro";
import TopLanguageButton from "../components/TopLanguageButton.astro";

interface Alt { lang: string; url: string }

const {
  lang = "th",
  alternates = [] as Alt[],
  showNavLinks = true,
  showNav = true,
  title,
  description,
} = Astro.props as {
  lang?: "th" | "en";
  alternates?: Alt[];
  showNavLinks?: boolean;
  showNav?: boolean;
  title?: string;
  description?: string;
};

const defaultTitle = lang === "en" 
  ? "Smart Bed - Innovative Hospital Care Solutions"
  : "Smart Bed - นวัตกรรมการดูแลผู้ป่วย";

const defaultDescription = lang === "en"
  ? "Smart Bed provides innovative hospital bed solutions with advanced adjustment features for better patient care."
  : "Smart Bed นำเสนอนวัตกรรมเตียงผู้ป่วยอัจฉริยะ พร้อมฟีเจอร์ปรับท่าอัตโนมัติเพื่อการดูแลผู้ป่วยที่ดีขึ้น";
---

<!DOCTYPE html>
<html lang={lang} class="scroll-smooth">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>{title || defaultTitle}</title>
    <meta name="description" content={description || defaultDescription} />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700;800&family=Noto+Sans:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />


    {alternates.map((alt) => (
      <link rel="alternate" hreflang={alt.lang} href={alt.url} />
    ))}
    <meta name="theme-color" content="#0891b2" />
  </head>

  <TopLanguageButton lang={lang} alternates={alternates} />
  
  <body class="font-noto bg-white text-gray-800 antialiased min-h-screen overflow-x-hidden">
    {/* Navbar */}
    {showNav && (
      <Navbar 
        lang={lang} 
        showLinks={showNavLinks} 
        alternates={alternates} 
      />
    )}

    <main class="relative overflow-x-clip max-w-[100svw]">
      <slot />
    </main>

    {/* ปุ่มเลื่อนกลับไปด้านบน (ลอยมุมขวาบนโชว์ตลอด) */}
    <button
      id="scrollTopBtn"
      class="scroll-top-btn"
      aria-label={lang === "en" ? "Scroll to top" : "กลับขึ้นด้านบน"}
    >
      <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M5 15l7-7 7 7" />
      </svg>
    </button>

    <script>
      if (typeof window !== "undefined") {
        const setupScrollTop = () => {
          const btn = document.getElementById("scrollTopBtn");
          if (!btn) return;

          btn.addEventListener("click", () => {
            window.scrollTo({ top: 0, behavior: "smooth" });
          });
        };

        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", setupScrollTop);
        } else {
          setupScrollTop();
        }
      }
    </script>
  </body>
</html>

<style>
  :where(section[id]) { scroll-margin-top: 88px; }
  @media (min-width: 1024px) { :where(section[id]) { scroll-margin-top: 96px; } }

  @media (max-width: 767.98px) {
    html, body { overflow-x: hidden !important; max-width: 100vw !important; }
    main, section { overflow-x: hidden !important; max-width: 100vw !important; }
  }

  /* ปุ่ม Scroll to Top (ลอยมุมขวาบน โชว์ตลอด) */
  .scroll-top-btn {
    position: fixed;
    top: 20px;          /* ถ้าไปทับปุ่มภาษา ปรับเป็น top: 80px; ได้ */
    right: 24px;
    width: 54px;
    height: 54px;
    border-radius: 9999px;
    border: none;
    background: #00B4FF;
    color: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow:
      0 16px 32px rgba(0, 0, 0, 0.28),
      0 0 0 1px rgba(0, 0, 0, 0.10);
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
    transition: transform 0.2s ease;
    z-index: 80;
  }

  .scroll-top-btn:hover {
    transform: translateY(-2px);
  }

  .scroll-top-btn svg {
    width: 26px;
    height: 26px;
  }

  @media (max-width: 767.98px) {
    .scroll-top-btn {
      top: 16px;
      right: 16px;
      width: 48px;
      height: 48px;
      box-shadow:
        0 12px 26px rgba(0, 0, 0, 0.26),
        0 0 0 1px rgba(0, 0, 0, 0.10);
    }
  }

  /* ใช้ Inter เฉพาะหน้าภาษาอังกฤษ */
html[lang="en"] body {
  font-family: "Inter", "Noto Sans", system-ui, sans-serif !important;
}

/* หน้าภาษาไทยยังคงใช้ฟ้อนต์เดิม */
html[lang="th"] body {
  font-family: "Noto Sans Thai", "Noto Sans", system-ui, sans-serif !important;
}

</style>
